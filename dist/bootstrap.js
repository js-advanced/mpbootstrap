!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("react"),require("react-redux"),require("redux"),require("react-dom"));else if("function"==typeof define&&define.amd)define(["react","react-redux","redux","react-dom"],t);else{var n="object"==typeof exports?t(require("react"),require("react-redux"),require("redux"),require("react-dom")):t(e.react,e["react-redux"],e.redux,e["react-dom"]);for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(window,function(e,t,n,r){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.START="START",e.EVENT="EVENT",e.EXIT="EXIT",e.ABORT="ABORT",e.ROLLBACK="ROLLBACK"}(t.Command||(t.Command={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.EXTERNAL_ENTER=1]="EXTERNAL_ENTER",e[e.EXTERNAL_RETURN=2]="EXTERNAL_RETURN",e[e.END=3]="END"}(t.WorkflowStatus||(t.WorkflowStatus={}))},function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,u){function i(e){try{c(r.next(e))}catch(e){u(e)}}function a(e){try{c(r.throw(e))}catch(e){u(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,a)}c((r=r.apply(e,t||[])).next())})},u=this&&this.__generator||function(e,t){var n,r,o,u,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function a(u){return function(a){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,r=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===u[0]||2===u[0])){i=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){i.label=u[1];break}if(6===u[0]&&i.label<o[1]){i.label=o[1],o=u;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(u);break}o[2]&&i.ops.pop(),i.trys.pop();continue}u=t.call(e,i)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),a=n(10),c=n(11),s=n(12),l=n(13);function f(e){return i.combineReducers(r({workspace:s.workspace,workflow:l.workflow},e))}t.injectAsyncReducer=function(e,t,n){return o(this,void 0,void 0,function(){return u(this,function(r){switch(r.label){case 0:return e.asyncReducers[t]?[2]:(e.asyncReducers[t]=n,[4,e.replaceReducer(f(e.asyncReducers))]);case 1:return r.sent(),[2]}})})},t.configureStore=function(e){void 0===e&&(e={});var t=i.createStore(f({}),a.composeWithDevTools(i.applyMiddleware(c.default)));return t.asyncReducers={},t}},function(e,t){e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.openApp=function(e){return{type:"OPEN_APP",bundleName:e}},t.errorOpenApp=function(e){return{type:"ERROR_OPEN_APP",bundleName:e}},t.getCurrentState=function(e){return{type:"GET_CURRENT_STATE",currentState:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=function(e){return{type:"WF_INIT",options:e}},t.success=function(e){return{type:"WF_SUCCESS",body:e}},t.sendCommand=function(){return{type:"WF_SEND_COMMAND"}},t.error=function(e){return{type:"WF_ERROR",error:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(8),u=n(2),i=n(9),a=n(3).configureStore({});o.render(r.createElement(u.Provider,{store:a},r.createElement(i.LoaderApp,null)),document.getElementById("root"))},function(e,t){e.exports=r},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),u=this&&this.__assign||function(){return(u=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,u){function i(e){try{c(r.next(e))}catch(e){u(e)}}function a(e){try{c(r.throw(e))}catch(e){u(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,a)}c((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,r,o,u,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function a(u){return function(a){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,r=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===u[0]||2===u[0])){i=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){i.label=u[1];break}if(6===u[0]&&i.label<o[1]){i.label=o[1],o=u;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(u);break}o[2]&&i.ops.pop(),i.trys.pop();continue}u=t.call(e,i)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(1),s=n(2),l=n(3),f=n(14),p=n(5),d=n(15),h=n(17),y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.firstRender=!0,t.currentBundle="",t.onPopState=function(e){t.props.openApp(window.location.hash.substr(1))},t}return o(t,e),t.prototype.componentDidMount=function(){d.listen(window,"popstate",this.onPopState)},t.prototype.componentWillUnmount=function(){console.info("WillUnmount")},t.prototype.downloader=function(e){return i(this,void 0,void 0,function(){var t,n;return a(this,function(r){switch(r.label){case 0:return t=e,"defaultapp"===e&&(t="main-landing/"+e),"radio/radioapp"===e&&(t="radioapp"),this.currentBundle=e,n=this,[4,f.loadApp(t,this.props.errorOpenApp)];case 1:return n.App=r.sent(),this.setState({appLoaded:!0}),window.history.pushState({flowName:e},"","/#"+e),[2]}})})},t.prototype.render=function(){var e=this,t=this,n=t.props,r=n.bundleName,o=n.errorbundleName,i=t.App,a=t.firstRender,f=t.state,p=t.currentBundle;return o&&alert("Приложение "+o+" загрузить не удалось"),r!==p?(console.log(333),this.downloader(r),c.createElement("div",null,"Идет загрузка...")):a&&f&&this.state.appLoaded?(a=!1,console.log(222),i?c.createElement(s.ReactReduxContext.Consumer,null,function(t){var n=t.store;return l.injectAsyncReducer(n,"app",i.reducer),e.setState({appLoaded:!1}),c.createElement(i,u({},e.props))}):c.createElement("div",null,"Идет загрузка...")):(console.log(111),i?c.createElement(i,u({},this.props)):c.createElement("div",null,"Идет загрузка..."))},t}(c.PureComponent);t.LoaderApp=s.connect(function(e){return{errorbundleName:e.workspace.errorbundleName,bundleName:e.workspace.bundleName||window.location.hash.substr(1)||"defaultapp",data:e.workflow.data,stateName:e.workflow.stateName,flowName:e.workflow.flowName,history:e.workflow.history||[],isLoading:e.workflow.isLoading}},function(e){return{openApp:function(t){return e(p.openApp(t))},initFlow:function(t,n){return e(h.initFlow(t,n))},sendStateEvent:function(t,n){return e(h.sendStateEvent(t,n))},errorOpenApp:function(t){return e(p.errorOpenApp(t))},rollback:function(t){return e(h.rollbackState(t))},exitApp:function(){return e(h.exitState())}}})(y)},function(e,t,n){"use strict";var r=n(4).compose;t.__esModule=!0,t.composeWithDevTools="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"==typeof arguments[0]?r:r.apply(null,arguments)},t.devToolsEnhancer="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__?window.__REDUX_DEVTOOLS_EXTENSION__:function(){return function(e){return e}}},function(e,t,n){"use strict";function r(e){return function(t){var n=t.dispatch,r=t.getState;return function(t){return function(o){return"function"==typeof o?o(n,r,e):t(o)}}}}n.r(t);var o=r();o.withExtraArgument=r,t.default=o},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o={bundleName:"",currentState:{flowName:"",stateName:"",eventName:""}};t.workspace=function(e,t){void 0===e&&(e=o);var n=t.bundleName,u=t.currentState;switch(t.type){case"OPEN_APP":return r({},e,{errorbundleName:void 0,bundleName:n});case"ERROR_OPEN_APP":return r({},e,{errorbundleName:n});case"GET_CURRENT_STATE":return r({},e,{currentState:u});default:return e}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0);t.workflow=function(e,t){void 0===e&&(e={isLoading:!1});var n=t.options,u=t.body,i=t.error;switch(t.type){case"WF_INIT":return r({},e,{url:n.url,flowName:n.flowName});case"WF_SUCCESS":return r({},e,{isLoading:["EXTERNAL_ENTER","EXTERNAL_RETURN"].indexOf(u.result)>-1,status:o.WorkflowStatus[u.result],stateName:u.state||e.stateName,flowName:u.flow||e.flowName,processId:u.pid||e.processId,url:u.url||e.url,data:u.output||e.data,history:u.history||e.history});case"WF_ERROR":return r({},e,{isLoading:!1,error:i});case"WF_SEND_COMMAND":return r({},e,{isLoading:!0});default:return e}}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,u){function i(e){try{c(r.next(e))}catch(e){u(e)}}function a(e){try{c(r.throw(e))}catch(e){u(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,a)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,o,u,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function a(u){return function(a){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,r=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===u[0]||2===u[0])){i=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){i.label=u[1];break}if(6===u[0]&&i.label<o[1]){i.label=o[1],o=u;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(u);break}o[2]&&i.ops.pop(),i.trys.pop();continue}u=t.call(e,i)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var u=n(5);t.loadApp=function(e,t){return r(this,void 0,void 0,function(){return o(this,function(n){switch(n.label){case 0:return[4,System.import("./"+e+".js").then(function(e){return e.default}).catch(function(n){console.info("Загрузить "+e+" не удалось!"),console.info("error in "+e,n),t(e)})];case 1:return[2,n.sent()]}})})},t.getWorkSpace=function(){return function(e,t){fetch("/getCurrentState",{credentials:"same-origin"}).then(function(e){return e.json()}).then(function(t){e(u.getCurrentState(t))})}}},function(e,t,n){"use strict";var r=n(16),o={listen:function(e,t,n){return e.addEventListener?(e.addEventListener(t,n,!1),{remove:function(){e.removeEventListener(t,n,!1)}}):e.attachEvent?(e.attachEvent("on"+t,n),{remove:function(){e.detachEvent("on"+t,n)}}):void 0},capture:function(e,t,n){return e.addEventListener?(e.addEventListener(t,n,!0),{remove:function(){e.removeEventListener(t,n,!0)}}):{remove:r}},registerDefault:function(){}};e.exports=o},function(e,t,n){"use strict";function r(e){return function(){return e}}var o=function(){};o.thatReturns=r,o.thatReturnsFalse=r(!1),o.thatReturnsTrue=r(!0),o.thatReturnsNull=r(null),o.thatReturnsThis=function(){return this},o.thatReturnsArgument=function(e){return e},e.exports=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(6),u=n(18);t.initFlow=function(e,t){return function(n,i){n(o.init(e));var a=i().workspace.currentState,c=a.flowName,s=a.eventName;c===e.flowName&&s?n(u.default(r.Command.EVENT,{name:s},{})):n(u.default(r.Command.START,{name:e.flowName},t))}};t.sendStateEvent=function(e,t){return function(n){n(u.default(r.Command.EVENT,{name:e},t))}};t.rollbackState=function(e){return function(t){t(u.default(r.Command.ABORT,{name:e}))}};t.exitState=function(){return function(e){e(u.default(r.Command.EXIT,{}))}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),u=n(6),i=n(19);t.default=function(e,t,n){return void 0===t&&(t={}),void 0===n&&(n={}),function(a,c){var s=c().workflow,l=s.url;s.processId,s.flowName;a(u.sendCommand());var f={cmd:o.Command[e],d:(new Date).getTime().toString()},p=r({},f,t);fetch("/"+l+"/"+i.createGetParams(p),{method:"POST",body:JSON.stringify(n),credentials:"same-origin",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){a(u.success(e))})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createGetParams=function(e){void 0===e&&(e={});for(var t=0,n="",r=0,o=Object.keys(e);r<o.length;r++){var u=o[r],i=e[u]?e[u]:"null";n+=0===t?"?":"&",n+=u+"="+encodeURIComponent(i.toString()),t++}return n},t.PushToHistory=function(e){window.history.pushState({flowName:e},"","/#"+e)}}])});